Szeret (nev, gyumolcs)
----------------------
CREATE TABLE Szeret(nev VARCHAR(15), gyumolcs VARCHAR(15));

NEV         GYUMOLCS
--------------------
Malacka     alma
Micimackó   alma
Malacka     körte
Kanga       alma
Tigris      alma
Malacka     dinnye
Micimackó   körte
Tigris      körte

Adjuk meg az alábbi lekérdezéseket relációs algebrában és SQL-ben:

1.  Melyek azok a gyümölcsök, amelyeket Micimackó szeret?
SELECT gyumolcs FROM Szeret WHERE nev = 'Micimackó';

2.  Melyek azok a gyümölcsök, amelyeket Micimackó nem szeret? (de valaki más igen)
SELECT gyumolcs FROM Szeret
 MINUS
SELECT gyumolcs FROM Szeret WHERE nev = 'Micimackó';

3.  Kik szeretik az almát?
SELECT nev FROM Szeret WHERE gyumolcs = 'alma';

4.  Kik nem szeretik a körtét? (de valami mást igen)
SELECT nev FROM Szeret
 MINUS
SELECT nev FROM Szeret WHERE gyumolcs = 'körte';

5.  Kik szeretik vagy a dinnyét vagy a körtét?
SELECT nev FROM Szeret WHERE gyumolcs = 'dinnye'
 UNION
SELECT nev FROM Szeret WHERE gyumolcs = 'körte';

6.  Kik szeretik az almát is és a körtét is?
SELECT nev FROM Szeret WHERE gyumolcs = 'alma'
 INTERSECT
SELECT nev FROM Szeret WHERE gyumolcs = 'körte';

7.  Kik azok, akik szeretik az almát, de nem szeretik a körtét?
SELECT nev FROM Szeret WHERE gyumolcs = 'alma'
 MINUS
SELECT nev FROM Szeret WHERE gyumolcs = 'körte';

----------- eddig volt korábban, lásd feladat1.txt
8.  Kik szeretnek legalább kétféle gyümölcsöt?
-- direkt szorzat
SELECT DISTINCT sz1.nev FROM Szeret sz1, Szeret sz2 
WHERE sz1.nev=sz2.nev AND sz1.gyumolcs <> sz2.gyumolcs;

9.  Kik szeretnek legalább háromféle gyümölcsöt?
-- még egy direkt szorzat
SELECT DISTINCT sz1.nev FROM Szeret sz1, Szeret sz2, Szeret sz3 
WHERE sz1.nev=sz2.nev AND sz2.nev=sz3.nev AND sz1.gyumolcs <> sz2.gyumolcs
AND sz2.gyumolcs <> sz3.gyumolcs AND sz1.gyumolcs <> sz3.gyumolcs;

10. Kik szeretnek legfeljebb kétféle gyümölcsöt?
-- az összes névbõl kivonjuk azokat, akik legalább 3-at szeretnek
SELECT nev FROM Szeret
 MINUS
SELECT DISTINCT sz1.nev FROM Szeret sz1, Szeret sz2, Szeret sz3 
WHERE sz1.nev=sz2.nev AND sz2.nev=sz3.nev AND sz1.gyumolcs <> sz2.gyumolcs
AND sz2.gyumolcs <> sz3.gyumolcs AND sz1.gyumolcs <> sz3.gyumolcs;

11. Kik szeretnek pontosan kétféle gyümölcsöt?
-- Legalább kettõt szeretõkbõl kivonjuk a legalább hármat szeretõket.
SELECT DISTINCT sz1.nev FROM Szeret sz1, Szeret sz2 
WHERE sz1.nev=sz2.nev AND sz1.gyumolcs <> sz2.gyumolcs
 MINUS
SELECT DISTINCT sz1.nev FROM Szeret sz1, Szeret sz2, Szeret sz3 
WHERE sz1.nev=sz2.nev AND sz2.nev=sz3.nev AND sz1.gyumolcs <> sz2.gyumolcs
AND sz2.gyumolcs <> sz3.gyumolcs AND sz1.gyumolcs <> sz3.gyumolcs;


Dolgozo és Osztaly táblák
-------------------------
Dolgozo (dkod, dnev, foglalkozas, fonoke, belepes, fizetes, jutalek, oazon)	   
Osztaly (oazon, onev, telephely)
--------------------------------
10  ACCOUNTING  NEW YORK
20  RESEARCH    DALLAS
30  SALES       CHICAGO
40  OPERATIONS  BOSTON

CREATE TABLE Osztaly(
 oazon      NUMERIC(2),
 onev       VARCHAR(14),
 telephely  VARCHAR(13)
);


Lekérdezések  (rel. alg + SQL)
------------
1.  Kik azok a dolgozók, akiknek a fizetése nagyobb, mint 2800?
2.  Kik azok a dolgozók, akik a 10-es vagy a 20-as osztályon dolgoznak?
3.  Kik azok, akiknek a jutaléka nagyobb, mint 600?
4.  Kik azok, akiknek a jutaléka nem nagyobb, mint 600?
5.  Kik azok a dolgozók, akiknek a jutaléka ismeretlen (nincs kitöltve, vagyis NULL)?
SELECT dnev, jutalek FROM Dolgozo WHERE jutalek IS NULL;

6.  Adjuk meg a dolgozók között elõforduló foglalkozások neveit.
SELECT DISTINCT foglalkozas FROM Dolgozo;

7.  Adjuk meg azoknak a nevét és kétszeres fizetését, akik a 10-es osztályon dolgoznak.
SELECT dnev, fizetes*2 FROM Dolgozo Where oazon=10;

8.  Kik azok a dolgozók, akik 1982.01.01 után léptek be a céghez?
SELECT dnev FROM Dolgozo where belepes > to_date('1982.01.01', 'yyyy.mm.dd');

9.  Kik azok, akiknek nincs fõnöke?
SELECT dnev FROM Dolgozo WHERE fonoke IS NULL;

10. Kik azok a dolgozók, akiknek a nevében van 'A' betû?
SELECT dnev FROM Dolgozo WHERE dnev LIKE '%A%';

11. Kik azok a dolgozók, akiknek a nevében van két 'L' betû?
SELECT dnev FROM Dolgozo WHERE dnev LIKE '%L%L%';

12. Kik azok a dolgozók, akiknek a fizetése 2000 és 3000 között van?
SELECT dnev, fizetes FROM Dolgozo WHERE fizetes BETWEEN 2000 AND 3000;

13. Adjuk meg a dolgozók adatait fizetés szerint növekvõ sorrendben.
14. Adjuk meg a dolgozók adatait fizetés szerint csökkenõ, azon belül név szerinti sorrendben.
SELECT dnev, fizetes FROM Dolgozo ORDER BY fizetes DESC, dnev;

15. Kik azok a dolgozók, akiknek a fõnöke KING? (egyelõre leolvasva a képernyõrõl KING dkod-ját) 
----------- eddig volt korábban, lásd feladat1.txt
16. Kik azok a dolgozók, akiknek a fõnöke KING? (nem leolvasva)
SELECT beo.dnev FROM Dolgozo beo, Dolgozo fon 
WHERE fon.dkod=beo.fonoke AND fon.dnev='KING';

17. Adjuk meg azoknak a fõnököknek a nevét, akiknek a foglalkozása nem 'MANAGER'. (dnev)
SELECT fon.dnev, fon.foglalkozas FROM Dolgozo beo, Dolgozo fon 
WHERE fon.dkod=beo.fonoke AND fon.foglalkozas <> 'MANAGER';

18. Adjuk meg azokat a dolgozókat, akik többet keresnek a fõnöküknél.
SELECT beo.dnev, beo.fizetes, fon.fizetes FROM Dolgozo beo, Dolgozo fon 
WHERE fon.dkod=beo.fonoke AND fon.fizetes < beo.fizetes;

19. Kik azok a dolgozók, akik fõnökének a fõnöke KING?
SELECT beo.dnev FROM Dolgozo beo, Dolgozo fon, Dolgozo king 
WHERE beo.fonoke=fon.dkod AND fon.fonoke=king.dkod AND king.dnev='KING';

20. Kik azok a dolgozók, akik osztályának telephelye DALLAS vagy CHICAGO?
21. Kik azok a dolgozók, akik osztályának telephelye nem DALLAS és nem CHICAGO?
SELECT dnev, telephely FROM Dolgozo d, Osztaly o 
WHERE d.oazon=o.oazon AND telephely NOT IN ('DALLAS', 'CHICAGO');

22. Adjuk meg azoknak a nevét, akiknek a fizetése > 2000 vagy a CHICAGO-i osztályon dolgoznak.
23. Melyik osztálynak nincs dolgozója?
SELECT oazon FROM Osztaly
 MINUS
SELECT oazon FROM Dolgozo;

24. Adjuk meg azokat a dolgozókat, akiknek van 2000-nél nagyobb fizetésû beosztottja.
SELECT fon.dnev, beo.dnev, beo.fizetes 
FROM Dolgozo beo, Dolgozo fon WHERE beo.fonoke=fon.dkod AND beo.fizetes > 2000;

25. Adjuk meg azokat a dolgozókat, akiknek nincs 2000-nél nagyobb fizetésû beosztottja.
SELECT dnev FROM Dolgozo
 MINUS
SELECT fon.dnev FROM Dolgozo beo, Dolgozo fon WHERE beo.fonoke=fon.dkod AND beo.fizetes > 2000;

26. Adjuk meg azokat a telephelyeket, ahol van elemzõ (ANALYST) foglalkozású dolgozó.
SELECT telephely FROM Dolgozo d, Osztaly o WHERE d.oazon=o.oazon AND foglalkozas = 'ANALYST';
 vagy ezzel ekvivalens megoldás
SELECT telephely FROM Dolgozo d JOIN Osztaly o ON d.oazon=o.oazon WHERE foglalkozas = 'ANALYST';
 vagy egy harmadik ekvivalens megoldás
SELECT telephely FROM Dolgozo NATURAL JOIN Osztaly WHERE foglalkozas = 'ANALYST';

27. Adjuk meg azokat a telephelyeket, ahol nincs elemzõ (ANALYST) foglalkozású dolgozó.
28. Adjuk meg azoknak a dolgozóknak a nevét, akiknek a legnagyobb a fizetésük.
-- Az összes névbõl levonjuk azokat, akiknél van nagyobb fizetésû
SELECT dnev FROM Dolgozo
 MINUS
SELECT d1.dnev FROM Dolgozo d1, Dolgozo d2 WHERE d1.fizetes < d2.fizetes;

További feladatok gyakorlásra a tankönyvbõl
-------------------------------------------
HajoOsztalyok(Osztaly, tipus, orszag, agyukSzama, kaliber, vizkiszoritas)
Hajok(nev, Osztaly, felavatva)
Csatak(nev, datum)
Kimenetelek(hajo, csata, eredmeny)

Lekérdezések
------------

a) Adjuk meg azokat a hajóosztályokat a gyártó országok nevével együtt, amelyeknek az ágyúi
   legalább 16-os kaliberûek.
b) Melyek azok a hajók, amelyeket 1921 elõtt avattak fel?
c) Adjuk meg a Denmark Strait-csatában elsüllyedt hajók nevét.
d) Az 1921-es washingtoni egyezmény betiltotta a 35000 tonnánál súlyosabb hajókat. 
   Adjuk meg azokat a hajókat, amelyek megszegték az egyezményt. (1921 után avatták fel õket)
e) Adjuk meg a Guadalcanal csatában részt vett hajók nevét, vízkiszorítását és ágyúi­nak a számát.
f) Adjuk meg az adatbázisban szereplõ összes hadihajó nevét. (Ne feledjük, hogy a Hajók relációban 
   nem feltétlenül szerepel az összes hajó!)
!g) Adjuk meg azokat az osztályokat, amelyekbe csak egyetlenegy hajó tartozik.
!h) Melyek azok az országok, amelyeknek csatahajóik is és cirkálóhajóik is voltak?
!i) Adjuk meg azokat a hajókat, amelyek "újjáéledtek", azaz egyszer már megsérültek egy csatában, 
    de egy késõbbi csatában újra harcoltak.
