︠ffcf4650-dcf9-432a-9ff2-4849d8a84b7fs︠
#5 Írjon SSS_secret_pieces(required_num_of_people, num_of_people, secret) szignatúrával függvényt, amely a secret titokból num_of_people db titokrészletet készít, ahol a minimum szükséges részletek száma required_num_of_people. A függvény véletlenszerűen válasszon ki egy alkalmas polinomot és prímszámot. A prímszám legyen kellően távol a titoktól (a függvény adja eredményül azt is, melyik prímszám lett kiválasztva).

def SSS_secret_pieces_from_primenum_and_coeffs(num_of_people, secret, primenum, coeff) :
    list_of_coeff = coeff + [secret]
    list_of_coeff.reverse()
    poly = GF(primenum)['x'](list_of_coeff)
    result = []
    for i in [1..num_of_people]:
        result.append((i,poly(i)))
    return result

def SSS_compute_secret(primenum, secret_pieces):
    return GF(primenum)['x'].lagrange_polynomial(secret_pieces)(0)

def SSS_secret_pieces(required_num_of_people, num_of_people, secret) :
    #ide sokféle megoldás elképzelhető
    primenum = next_prime(10 * max(num_of_people,secret) * randint(1, secret))
    coeff = [randint(1,primenum-1) for x in [1..required_num_of_people-1]]
    return (primenum,SSS_secret_pieces_from_primenum_and_coeffs(num_of_people, secret, primenum, coeff))

SSS_secret_pieces(3, 4, 5)

#6 A 34fg__#Gfb34226fdsWWQl36lII234i<!%fGZjsdJFEBD77467effO+36{}__IOQsFF&363&ZzOO053 jelszóhoz készítsen titokrészleteket, amelyet 10 ember között osztunk szét úgy, hogy legalább 7 ember szükséges legyen az eredeti jelszó előállításához. Adott 7 titokrészletből állítsa elő az eredeti jelszót.
#a sztriget értelmezzük 256-os számrendszerbeli számként

password =list( "34fg__#Gfb34226fdsWWQl36lII234i<!%fGZjsdJFEBD77467effO+36{}__IOQsFF&363&ZzOO053")
password.reverse()

result = 0
i = 0
for ch in password :
    result += ord(ch) * 256^i
    i += 1

#SSS_secret_pieces(7, 10, result)
#SSS_compute_secret(49557621609138893841717995758027665050857157174832231265655876795156424867672583504692652714984519005854773042840779006313348636458889630658520032192721482387501921625810285181064962507442881414100340722453853201427089403706885131503629655603884203361893225557603932309405538922775816012221824169746837185814657443599702519948419481128198111028890239072402946441178489602781662607,[(1, 43506870613536677236029220425085288056338864034283364847745947355315010189244380838266100954437997318170192163014176921864079330563169699863521631507156562959863021954424335565059216382055535222603162418135342438337506271663981316255822369025320327940639353425029723610634011942520191237552530185648376366968764695943513467117321088175825104786113462670284560373644866215415194486), (2, 16415605458104978904807547728619167116094730804784296941783489826124873331663337781566907484766586604976964199006036033516665970809897910925648437106618798148503235548635682439120495173711922047687003587464429487115329591185519069916429855928199623203570362719865301707189463431991649686709506971451662381786313287163614092127271947116262876264788660943925151646719777751069522525), (3, 37087754140850999438018589187241112027572307405712655619234673570684408569745164176182871224505112334453054986752138939774941572119916723651840271570543779655862434673302285282746802308169893585494517743598059077137424361564343270257052570210143386274101356282785326051359655638987566345055757025804885965813232617213567620344939094899499225092180080573095770869861614942859908831), (4, 1200022462147345264139405841700895953979016400103648587808810410568787769404777560538154661263667691978065244461955856715004290510742478867034621795070166496196887177268404780143594841122713290461470110725435117677986583008995755215908752486433907274241612203638077665962012038754552561563444172411100528624699544827725823754802771527868168705733745584255429741657104529229473469), (5, 42002812669161668971996460629614374339556055361745282390678503961697145414706504698124838169170214432536625471781216252779486902343093139400076007309658343116529231875321088476823893239021374182321915391067504002802147169480197336155757206000901117900027587529114101346329906271256869496397782497658417984282085675079127833369037777978284096717733813457389049715968124846035881132), (6, 26861123280136535777646287453121064854499881842962621397500220462572337897468849918770413731108270764789011348537590875176744765578268383145695346255204414145276437385798094310498238673774242539712640420882424922896318816123355891613580028648516517369852186709644866446661661270241248705997007134832623296762412203740057135055918800888750239782462389832790531565869857939041900801),(7, 22825051235797482121582715744522460302103253586715874682158599310837422040982003451262021235161408489290355261019086407792210448484188013226320542347065866493628766204638088896723073114153524780922886904442520483751969353162113148558676900462775441380531254990854330054649060726458056191904922131573921413139784187063544661906009032854356355594875421035661075398239304944670468008)])

secret = 3564733067735719071646687286191003377609878724686405481337882898389016373456046506323076878927861827176786281900611822489011829592155079319045973686683531183534466558164788076421842157450547

secret_list = []

while secret > 0 :
    secret_list.append(chr(secret % 256))
    secret //= 256

secret_list.reverse()
secret_string = "".join(secret_list)
secret_string

︡da5d42b9-962f-4abd-a862-a15aedd54156︡{"stdout":"(53, [(1, 23), (2, 17), (3, 40), (4, 39)])\n"}︡{"stdout":"'34fg__#Gfb34226fdsWWQl36lII234i<!%fGZjsdJFEBD77467effO+36{}__IOQsFF&363&ZzOO053'\n"}︡{"done":true}









