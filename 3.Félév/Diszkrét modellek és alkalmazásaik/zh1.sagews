︠cbe5695d-0cae-478d-b545-0460b11a1358r︠
#2

def foo(original, pattern, change) :
    result = original.split(pattern)
    res = ""
    if len(result) < 3 :
        return ""
    for a in [0..len(result)-1]:
        if (a == len(result)-3):
            res = res + result[a]
            res = res + change
        else:
            res = res + result[a]
            res = res + pattern
    return res
foo("This string/string is my dummy string in this exercise about strings.", "string", "FOO")

︡218f32c9-e728-487a-a566-15015911f5b5︡{"stdout":"'This string/string is my dummy FOO is my dummy string in this exercise about s.string'\n"}
︠ab79e0ad-e453-47a5-980e-91f07a8a6760︠
#3

def agoh_giuga(n) :
    for i in [2..n] :
        if is_prime(i) :
            res = 1
            for s in [1..i-1] :
                res += s^(i-1)
            if res % i != 0 :
                return False
    return True
agoh_giuga(1000)

︡4d03b6cd-c85d-46fc-a1d6-430df824a0ae︡{"stdout":"True"}︡{"stdout":"\n"}︡{"done":true}
︠973feb02-eff8-4fe6-830c-c06ef07eed48o︠

#4

def SSS_secret_pieces_from_primenum_and_coeffs(num_of_people, secret, primenum, coeff) :
    list_of_coeff = coeff + [secret]
    list_of_coeff.reverse()
    poly = GF(primenum)['x'](list_of_coeff)
    result = []
    for i in [1..num_of_people]:
        result.append((i,poly(i)))
    return result

def SSS_compute_secret(primenum, secret_pieces):
    return GF(primenum)['x'].lagrange_polynomial(secret_pieces)(0)

def SSS_secret_pieces(required_num_of_people, num_of_people, secret) :
    #ide sokféle megoldás elképzelhető
    primenum = next_prime(10 * max(num_of_people,secret) * randint(1, secret))
    coeff = [randint(1,primenum-1) for x in [1..required_num_of_people-1]]
    return (primenum,SSS_secret_pieces_from_primenum_and_coeffs(num_of_people, secret, primenum, coeff))

secret = list("RcazVYTG23g8XVHnqh_NZXRt8W3mVDympNuMqTLVQCpA__@MPxXTZxrYaArT.Pw97VQ6n5N4whkRgzfUc@st___JThAa2R874")
secret.reverse()

result = 0
i = 0
for ch in secret :
    result += ord(ch) * 128^i
    i += 1

SSS_secret_pieces(12, 30, result)

primenum = 3959697310590986704574323222086210717091653885454799750883878276707843476788839862321532397130558978898667482765137499233169659713375094065572498999851704604676709075596149492476317463109881552630159757254708567237210868652028219146301321449140673851647361415416565282228668569308186218762590476965095423228055995897079472829984165484032421239294443217841847111207639938941010611028056882101186443872453299187

bad = SSS_compute_secret(primenum, secret_pieces,[(1, 2088839362363570932421054347743983063709261690484613609160220909908269521599053115723977819467257094151869622986766319719191090565505718242563519249577203289008372406369437252959881041804276595995634089335526208259068665771446823699409422670409371499376608444978658871896580612968540518799832712002519804392079663009763697877371708477063906438115541384760882895002878899210854440303326543013407358724306114017), (2, 336122530017485070685238962015928427507691283296516170288081721301485454706893921729543068549843321828738541720734301819447297197918732754878664379312127831299766839941697782625365315928497465689487470434124645082355058115932192027457136376113287306411305309811225652763613854691285175348943424344998663000846038030435949998180957642640955792675866261885428744891728445289208715060581672746323776997155968177), (3, 1800637795432100974333177607089312096965107182074807339681240937699839969714861961041251277643572626729769058401340763349258937112495684902710861594485226664422194204125934801314275675572254394070793323921943753353331056924916063578620456926190602557670017799865564887826370078030572417664841123573403842840124772510712057788627314267745064096977451634107189465224907550283669420414467156702022591591180292392), (4, 2344958919370763283497792300371119533130903763829116682110245407346258805633344293952689814732348713052841922720175727521412484111852527567232707610383935067954963407809661418516425045157334410171077433189689174163376472986035891383077860435741700049597963825156860040316725316790934020358164479530536120862374422081458856377253212601074522780182418236588572908588472454920428473533843096969675601616206887590), (5, 2749100830406706844922053079811704182600178973878500799025709887735022173516974364761562883418439067120211455537003631893599633714075507507137527913119934042360111505373720683579964679120202674975173052123401892733017340643301768965179174171614677611139869780024441128629579054000066860163071326547603166633435246543264411860957756530965883372100379253672430673218782534431889000941851661286119229791440080223), (6, 630639346625579248015212528846787116099726997660464928877837917408925475365106246630233441894644427772672998592083003773409477534147502784769525301486458024952085869297998374970677810519021161373700112675168129083278627967928463561590253466268600031696485061023136776543753182521785850093688045542174791467989175483653221863996784002514548575806772725250445805101644803145230569861169867442730576381768234635), (7, 2540985290916144684858141443788843343073921146385907594070589664107573525306007385875875407158879400593998426843345083027257516732322274232594977077700523557463125550924988406541568868120947842064343316200389545628207771721890606067381583527879817494307825271287736166858471011029334578973140282045984952696156685483715336509591291496307708407378219605062372709569266975781326145157214638754473380938379940006), (8, 3952330950087541584165731947491851364995885883048885468360198711341052195114567240559242890337963334093562565535317479892982739038287953204715953924199905131170443414976741323445098312440192180649901877784414552252760220600562182307439606080990734555178884724286567056268809511711405782745705082510584682657089643110861775623408399412032649455663286796475911058425712855601702287710225525974928376293765091009), (9, 3951622419699264674319886100679731786789368558003281596375881345912120342546089962813980497367508476755456472826927427527684457989038473368363319822828119360375372601195260144743967701797353859650189739857261396453379526937870644289693908832902761474355960855060490324070023702162358351873512516287587432914706566989714344454964839797617149892247639692239335444046913475435128497411977683211698607534259610879), (10, 2020379067097506595904892143759313419528402266044672964413652290446987412204908256117823787230814804680696065201344504291682906624975762632515870901706704481073531119624951240289148262688622271447793041620789298574986812344610402201279588591163871362327675412106824271951371257438776768873946166675686382083481010852543300615047492164429910196160962740119012622851260555036934699517770645464828083342412616619), (11, 1439758089654146721383018241844589084488204441705993503843411820689228137519281807043651208676132985695421763231688512725720401296789041000781961809929486288698236864870693736693451943258962071074173945404614726044489430313935749664530603503987095627958472570589269524211476719431427998382703581525901318725855721733742372447754851535503916101777692284682580742362924774796482639022086883857116720487249508208)])

good = SSS_compute_secret(primenum, secret_pieces,[(1, 2088839362363570932421054347743983063709261690484613609160220909908269521599053115723977819467257094151869622986766319719191090565505718242563519249577203289008372406369437252959881041804276595995634089335526208259068665771446823699409422670409371499376608444978658871896580612968540518799832712002519804392079663009763697877371708477063906438115541384760882895002878899210854440303326543013407358724306114017), (2, 336122530017485070685238962015928427507691283296516170288081721301485454706893921729543068549843321828738541720734301819447297197918732754878664379312127831299766839941697782625365315928497465689487470434124645082355058115932192027457136376113287306411305309811225652763613854691285175348943424344998663000846038030435949998180957642640955792675866261885428744891728445289208715060581672746323776997155968177), (3, 1800637795432100974333177607089312096965107182074807339681240937699839969714861961041251277643572626729769058401340763349258937112495684902710861594485226664422194204125934801314275675572254394070793323921943753353331056924916063578620456926190602557670017799865564887826370078030572417664841123573403842840124772510712057788627314267745064096977451634107189465224907550283669420414467156702022591591180292392), (4, 2344958919370763283497792300371119533130903763829116682110245407346258805633344293952689814732348713052841922720175727521412484111852527567232707610383935067954963407809661418516425045157334410171077433189689174163376472986035891383077860435741700049597963825156860040316725316790934020358164479530536120862374422081458856377253212601074522780182418236588572908588472454920428473533843096969675601616206887590), (5, 2749100830406706844922053079811704182600178973878500799025709887735022173516974364761562883418439067120211455537003631893599633714075507507137527913119934042360111505373720683579964679120202674975173052123401892733017340643301768965179174171614677611139869780024441128629579054000066860163071326547603166633435246543264411860957756530965883372100379253672430673218782534431889000941851661286119229791440080223), (6, 630639346625579248015212528846787116099726997660464928877837917408925475365106246630233441894644427772672998592083003773409477534147502784769525301486458024952085869297998374970677810519021161373700112675168129083278627967928463561590253466268600031696485061023136776543753182521785850093688045542174791467989175483653221863996784002514548575806772725250445805101644803145230569861169867442730576381768234635), (7, 2540985290916144684858141443788843343073921146385907594070589664107573525306007385875875407158879400593998426843345083027257516732322274232594977077700523557463125550924988406541568868120947842064343316200389545628207771721890606067381583527879817494307825271287736166858471011029334578973140282045984952696156685483715336509591291496307708407378219605062372709569266975781326145157214638754473380938379940006), (8, 3952330950087541584165731947491851364995885883048885468360198711341052195114567240559242890337963334093562565535317479892982739038287953204715953924199905131170443414976741323445098312440192180649901877784414552252760220600562182307439606080990734555178884724286567056268809511711405782745705082510584682657089643110861775623408399412032649455663286796475911058425712855601702287710225525974928376293765091009), (9, 3951622419699264674319886100679731786789368558003281596375881345912120342546089962813980497367508476755456472826927427527684457989038473368363319822828119360375372601195260144743967701797353859650189739857261396453379526937870644289693908832902761474355960855060490324070023702162358351873512516287587432914706566989714344454964839797617149892247639692239335444046913475435128497411977683211698607534259610879), (10, 2020379067097506595904892143759313419528402266044672964413652290446987412204908256117823787230814804680696065201344504291682906624975762632515870901706704481073531119624951240289148262688622271447793041620789298574986812344610402201279588591163871362327675412106824271951371257438776768873946166675686382083481010852543300615047492164429910196160962740119012622851260555036934699517770645464828083342412616619), (11, 1439758089654146721383018241844589084488204441705993503843411820689228137519281807043651208676132985695421763231688512725720401296789041000781961809929486288698236864870693736693451943258962071074173945404614726044489430313935749664530603503987095627958472570589269524211476719431427998382703581525901318725855721733742372447754851535503916101777692284682580742362924774796482639022086883857116720487249508208),(12, 2875591182657385787017603204427071909006047775192060098647614452624540860297960617430650763363981941480246042898683156962522703711938874467926884574482066872348813875297478243494423410491808313120617817637658277876321759586528235664367500074413934405563235084421070379614466680875522469947625096800218142800958258295112354527639514726783701088529029428899438597974192288781375076541120251323988013720277952133)] )

secret = result

bad_list = []

while bad > 0 :
    bad_list.append(chr(secret % 128))
    bad //= 128

bad_list.reverse()
bad_string = "".join(good_list)
bad_string

good_list = []

while good > 0 :
    good_list.append(chr(secret % 128))
    good //= 128

good_list.reverse()
good_string = "".join(good_list)
good_string


︡0af6c43a-3caa-4cb5-80ea-ef1d07e7ab53︡{"stdout":"(3069696407205264906294428167233584445821276068825531166598879307715909970430922148985111843703338525591719753063319426542085875194852937379599848191544610341231161310886693358252362368744107216624388127466465794965731912329910090903655257795588476510316847656247386440651906338476530344234130513850851876950603931346081072073759143705885330850580769240971450901961255427911482064832575974271175389121827731963, [(1, 2159793776012423664304877974469405261018869157424201987476106680072846448227850584258848835600645404713743946259097184557157549566919240692419785773645747097703434591320696284720193158431601318325351343248701051742748104499800809246831957972355395391386738191937866493519829720760740803861925827827830323275737169104181217819926268832116846805460378766025646993836869309800743187323542789776590404919350925779), (2, 2107880710324588843309953403741384485578356688253802367935496814665375336658112962378316057915954782595814563582827938196322635818252949549288109102979312092101548460256672306613346830136252874333222710305752893646364083891975921246298292980423061033859622398209960642284065312029729035235739121975796891568086868461629954395076741176908865375688063669823889337705373811601283978208892281577009082608498381343), (3, 535047961866407840784939402994964418723896194941856814926495036211967325992785755439443859658530470457001732624272506139238790167610019477096007701962681582100062439423366472010016752116001766891544278310815617189857481256659633180923649191525120897357146356462190457999886879572223228318047751272660725375380445289407074343142548634977494525503660832578390697460627427078458949694284629436078231283399658646), (4, 2313060447085937344158144143130967365367903493598436904457702291889446471972160420952835212642114835071995710514060614983573963149871128493042344025045294638506692008453773173595985000452640760972318520865626413234184165466475527583926710780321653300373864279753651927744441064457908243015748194080210063415054789482299082668293870139849496353823978379504692028587092425815937482502258295978119460202911969529), (5, 2105193478644111297195284188343838466326998214010861049413061440518282406027686499903357332224285669163497760641516324460501765109372534716358021372560712626392560226976900537623188654278429885480347652317052128242822185795743355733945103203515981346351945701538731307870857923415206055029805448281291892123570884883453185773645627437207831746261170233132713016837275832483711395275206280313257321519502668494), (6, 2907390437442495421233429128533376436188792846668146074409372925839578973716820652651669617582496013909544061784307444369231256690170248722219650076699357760610662473164002966485348613594800493669194721749843911393642593193845238853682495592322373774811861993531375027427205980994701440266778703389447168029088312316051537788847040336791766243125522760011486895363325820297613876935582281195517574945829737831), (7, 2232628714342977046429347495259666255800010058028956435339279662301108120035600553162188936505098331195636795622411742968042376703528164774929020367323966264056518614691539836366307705568819471218624761032981529048568532701848411253311755373494999410339297594910125229470937553126552664085516981444059128438753258056031618299606609814122952825172673661184454399146375004253167552037394021876499415947774075873), (8, 1364908729089667200928227901317230835997883247477792048159359155161178114177195995313085880894084387374713071377500547621097711541571015695833963498904828464335119831220275049652179842706156919196463403398810647219582582712498887212635998272142639875293549667895769056171055640291023922590858409369288159199352895378151433898210277899281663498039217941963287680653843522286173307708613002875768612318784165977), (9, 1698907094393569709960716981336370872029331430501016449851353997619140052105685665118146334775135104110453948416282723599412626963876296614607046505086656116411499215260794150697554908296685218489826450778405730040034688148935806936049261482597225153108270942286196663570198819065082161811588542016417135360804987993112901923090236498427488251768299314958578435849181548489702533053186632199134409927749337603), (10, 2501754362752677759517058214817027964492343937317355005024015626785763095441645127736181623970259163944824763129733856298524588414766150847428007851098670074547592427564584497337352480366180299410609958511974574101933943292944645279593604768528216208919059280429478615286057221021111740743086121960919590883830591651887893014516918769687334243276435069942694464249286966670201353410681274381215587384741549995), (11, 1931267945134851593047792985084035184541576366298085783981467656265144195239811350046715908741291498392462561992713422985857109227422942236287762362277811715096021764626499521668427274551696329708898016712232234995304076071451132156028811293803833118690418162022705527779505484976569476187371461576733561480783484714966585918787704541127022956310424751704191793129416031205863082480749157678789765448255091431), (12, 2885727816884036997338195544726184527059073685208336998932063016694951096183005385854282921058162577867033387209178159273814965110869818041265503267616974108122236336958189073855383334392371903380731341007960401325184101918002329224372468363444055622483466179099484685847022922346256786834442442196692117902187410762553821548447862611024793506765148851963023785834075612502460270896198571152816792830649859885), (13, 2076697324744550808759416333866913751316479254364905499985101929738842853971320803499756400126337032085037906550071538256702185205142563241529963894866987706452476139101625065097641975569941529915653966833599227776060901438914494189581122750447953156962416872646040201884668292012971704572436417414126313640188346001525870494570503031919164840918534932213960299168894349463992978590971316953761278314089491123), (14, 923674673073979513841233595805190844788330387277765047390326673596227781584389618165390770581975745041454380883346597208228036748018497105557617815528031083146130744374163511465440392274018281943597270980771431573204209425926223272598743427531862397121241575757360999289553368224976320986426987568953479741435170280788234500554079280950600515913955558477526407632997709202233907078455453154890330468058515401), (15, 1671309590991381918981281149321935152450480547048881053869133509021290240352617312391071985299183310312016216039549219203388969436777088567316204719321735914437975699639526133729264346183637549118763921931304514535236914336192579273891271658823303445282184962060656779984284862970925456137381911303581302810076496658593566813632670105023803499116739544991123308209746254805574697402543923614860032976401154108), (16, 1879376247540013172799619448096754786313182261646191959569128067703870550389763256873127438103004357274582685774475751056240830749357970374858771166429307383644405792955069359969671373029462611178536482924938254872701372383623592631810590143152690184770288142715762437943950007250146625411691524133227297975699001772165174580349090201536308519094694796217996290616153800497455151105452396660640329284632499667), (17, 2934711619422458880670440202340126859342235927949163176929896315259720804213215359186198451088785059944776856760714572366979572243742893152939389413885230032364322095783767942851630037214960442802583293848632503662070876156663193446071839817723999380629640718071923409233319264048970132045572471164341644945737616453053985170810153363240653966608917586740101450519865740370782451039732556805326920865104436231), (18, 394669916546277417336258728109710242578755691669188177825623868947620775369545762519166024003943962675752593606653295071255058380457563745595765698727898401053827362457024259421157481662941130622097697059481444144063060289177060176488268516039940572978215999924788931642764927677692934435113915642300413625644363267004041460798752450288223391049821295790349082026961388479039404299689563217842774894962594089), (19, 1023867007736812325655978554813406406924825801551430584257121503004622535704676840843049754699605075039807611665182634141384960258615658232315441384884536230469764701117870382583722465530288575901782509881454075118656528034255334033876669708645738212043501996412130595478723090497804680851416839012537131417086000573466076181183155404020361221068448797048094659925258230482828925615120995046187503070113980459), (20, 755329354406510469387731957160230835729417005366442947412438412732699229226827471487092959986664051322866843871073647466321223435481294673884006119543749196385180025945644990752269914322391548915320188756701126461445094684564711072307326472703519460053617097593128496603501153702880368926613875968636948033464940319224213518482905838208400579517072494262461839786520119280058848817596759758991725215335205080), (21, 2340576582363847093144034577045896263878504820176000698761105930823839404029767759573935009697738167871494977912251779446410512309840543588020389225926850987894473097752037114660385774236758876080625751110252346277996112508157752491182391934640800035302619984092518935888429525078899834244615805696175356931167786670856431696837554272543898736147856801827511666294802505128788174153392962026944573271407795686), (22, 2762078166922292285187145897075273153032703220930724736738369902246054216069327685642355734911849612114984608403775822593232752098120369850078888373753438927220703326412157970035334290245758991803730134924866298440921191168904891006675115182172030197753931832250236984641076868427049155072653645055783082367779644945799521218912690285598803292427970809555292545488081446162888673356286475451685809197531727442), (23, 1683860212235085946369475449935124034581550158485486364577760926824445407366917743156140459662960077278214214307328660967463448511850642478907465478073255969390016198484073819456669506154136264762710051168982952626090505490694247226522279674034416238987691124826156094983364271370449425126290366164131121647985110006928041696433358504029287386426923821362637364050432004145298601282473204075862340903541494217), (24, 2218441546641137405181275525453228840489863298549843342730607270637636490938576131559645934884928113585359374481475714674438775531306874429394753224509169786548882038471771421355688018859339561434847044190076525252350742383028299503665195150748460661761313286805725706496833950196986812942328321890394075674072269006838712083414837009918820570681202623987604317192071123703187579049201444208890574475885479579), (25, 2976685700480693824567602633287138291643846349850611079477243387515134381419508538405139278713447561962500675183623797808600509379558961750352649331432173644708199955496093708278783353849173768759884031540919764818180426692325297428627983860117053486948700056289582027106645566279246730233382552986932366044989953086185200970166733070123849537692506670688722513671846372389398569286570235801619995010327412117), (26, 1285804319995593169632688036142507251219683151167892458073685874439908792567704104201587125741725244608236984343821056522330817308879169007106029562891499005867472855368737079330161103775251059247966780103265505449377986713950391323007955808405888486345641941623162765481080144179871383649790197816693043767227665977055538833640756027373662560843294082777633759853954114003855468994755285210316648254959473202), (27, 1102994876439414323666059399425430561210040236316285065274214588854120951583574133012223538825920721800922447066854283825213569217535589984510313754816716775737240705289926958642204056106920500620996093128806769448644635692187507283740385227811260765481540456442963245062646347369391637585608284766018790828996813785174839244979539378978861220800171022907191219809340229679275071568590221135025934293216693258), (28, 448391816898411802655176462951647725075990393866132962599339100214464091891811043982918528140094097332282181912608804829728061608200340851380267435314515249563814202252746112506848910153634018360047099173499074449510560317406826383691176821864449218594491984345367564218095378314911574352918037175588515332281178009894045045263518762031781313979383126687554992321505117363206984893352820744599287156547644019), (29, 1895482857993706702826859578529731663482751278619717855870508312819522662620300317312590243959739166671396602665606148513956477775482706125256468896149994463465423827552071626542112459174536436198668846298136860144537084752999091075450397436592196469183660702442193523015272639531183040555279145045469553806779119773465572317800676405703161619343411303785012331564159571708419150079447147734930746451144784273), (30, 442804431545709409131166354134249937958814056545313714941580744186269832784662961648879173488232184874085968715021368470356751559332231066921636023123440308132443571470359518690187494350328267091508510805301309651112936513927228805095166248013019652246521451831549632724682267913429244494433267262971654953711698661471566968968631157545158509366460337727168942307823126421836732489693471897989496227747032811)])"}︡{"stdout":"\n"}︡{"stderr":"Error in lines 24-24\nTraceback (most recent call last):\n  File \"/cocalc/lib/python3.9/site-packages/smc_sagews/sage_server.py\", line 1230, in execute\n    exec(\n  File \"\", line 1, in <module>\nNameError: name 'secret_pieces' is not defined\n"}︡{"done":true}
︠3336d1ea-0d78-4b7c-874e-48dfe5e0ecc2︠

#5

def SSS_secret_pieces_from_primenum_and_coeffs_enhanced(num_of_people, secret, primenum, coeff, epsilon) :
    if epsilon < 0 :
        raise ValueError("Epsilon is not valid")
    list_of_coeff = coeff + [secret]
    list_of_coeff.reverse()
    poly = GF(primenum)['x'](list_of_coeff)
    result = []
    i = 1
    while (len(result) < num_of_people and i <= num_of_people or i <= primenum ) :
        piece = poly(i)
        num = piece - secret
        if num < 0 :
            num = num*-1
        if epsilon >= num :
            i = i + 1
            continue
        result.append((i,piece))
        i = i + 1
    if i > num_of_people and i > primenum :
        raise ValueError("Couldn't contruct secret pieces with epsilon")
    return result

SSS_secret_pieces_from_primenum_and_coeffs_enhanced(4 ,5 ,7 , [4,3], 6)

︡0e43b7fa-f817-4399-a3bb-edb0c03fb9fd︡{"stderr":"Error in lines 22-22\nTraceback (most recent call last):\n  File \"/cocalc/lib/python3.9/site-packages/smc_sagews/sage_server.py\", line 1230, in execute\n    exec(\n  File \"\", line 1, in <module>\n  File \"\", line 20, in SSS_secret_pieces_from_primenum_and_coeffs_enhanced\nValueError: Couldn't contruct secret pieces with epsilon\n"}︡{"done":true}









